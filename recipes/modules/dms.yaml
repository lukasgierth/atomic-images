---
modules:
  - type: dnf
    install:
      packages:
        - adwaita-icon-theme
        - breeze-icon-theme
        - material-icons-fonts
        - papirus-icon-theme

  - type: dnf
    repos:
      copr:
        - avengemedia/dms
        - gierth/tools-rust
      cleanup: true
    install:
      packages:
        - adw-gtk3-theme
        - NetworkManager
        - accountsservice
        - cava
        - cups
        - dgop
        - dms
        - dms-greeter
        - dolphin
        - dsearch
        - fprintd
        - gnome-disk-utility
        - gnome-keyring
        - gnome-keyring-pam
        - golang-bin
        - matugen
        - niri
        - pipewire
        - power-profiles-daemon
        - ptyxis
        - qt6-qtmultimedia
        - qt6ct
        - quickshell
        - swayimg # image viewer
        - wireplumber
        - wlctl
        - xdg-desktop-portal-gnome
        - xdg-desktop-portal-gtk
        - xwayland-satellite
        - zathura # pdf
        # - udiskie

    # TODO:
    # sed --sandbox -i -e '/gnome_keyring.so/ s/-auth/auth/ ; /gnome_keyring.so/ s/-session/session/' /etc/pam.d/greetd

  - type: script
    scripts:
      - dms-setup.sh

  - type: systemd
    user:
      enabled:
        - gnome-keyring-daemon.service
        - sync-greeter.service
        - dsearch.service
        - dms.service
    system:
      enabled:
        - cups.service
        - greetd.service
        - power-profiles-daemon.service
        - setup-greeter.service
        # - udiskie.service

  - type: files
    files:
      - source: dms-skel
        destination: /etc/skel
