---
modules:
  - type: dnf
    repos:
      copr:
        - avengemedia/dms
        # - avengemedia/danklinux
      cleanup: true
    install:
      packages:
        - NetworkManager
        - accountsservice
        - cava
        - cliphist
        - dgop
        - dms
        - dms-greeter
        - dsearch
        - gnome-keyring
        - gnome-keyring-pam
        - matugen
        - niri
        - qt6-qtmultimedia
        - qt6ct
        - quickshell
        - thunar
        - thunar-archive-plugin
        - thunar-volman
        - wl-clipboard
        - xdg-desktop-portal-gtk
        - xdg-desktop-portal-gnome
        - xwayland-satellite
        - zathura
        # are those needed explicit?
        # - pipewire
        # - wireplumber
        # - polkit-kde
        # - udiskie
        # - brightnessctl

    # TODO:
    # sed --sandbox -i -e '/gnome_keyring.so/ s/-auth/auth/ ; /gnome_keyring.so/ s/-session/session/' /etc/pam.d/greetd
    # add_wants_niri udiskie.service
  # remove:
  #  console-login-helper-messages \
  # chrony \
  # sssd* \
  # use:
  # systemctl enable systemd-timesyncd
  # systemctl enable systemd-resolved.service

  - type: script
    scripts:
      - dms-setup.sh

  - type: systemd
    user:
      enabled:
        - gnome-keyring-daemon.service
        - dsearch.service
        # - swayidle.service
        # - udiskie.service
    system:
      enabled:
        - greetd.service
        - setup-greeter-group.service
