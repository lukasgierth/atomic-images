modules:
  - type: dnf
    repos:
      files:
        - https://mise.jdx.dev/rpm/mise.repo
        - https://pkgs.tailscale.com/stable/fedora/tailscale.repo
      nonfree: rpmfusion
      cleanup: true
    remove:
      packages:
        - firefox
        - firefox-langpacks
        - htop
        - net-tools
        - ublue-os-just
        - ublue-os-update-services
        - vim
    install:
      packages:
        - ImageMagick
        - abcde
        - android-tools
        - ansible
        - aria2
        - arp-scan
        - bat
        - borgbackup
        - borgmatic
        - btop
        - cmake
        - ctags
        - curl
        - ddrescue
        - detox
        - dfu-util
        - distrobox
        - duf
        - esptool
        - f3
        - fastfetch
        - fd-find
        - ffmpeg
        - fish
        - fzf
        - gcc
        - gcc-c++
        - gdu
        - git
        - glibc-static
        - gzip
        - httpx
        - iperf3
        - luajit
        - make
        - mediainfo
        - mise
        - mosh
        - neovim
        - newsboat
        - nodejs
        - onefetch # for most of nvim lsp
        - pandoc
        - picocom
        - podman-compose
        - podman-tui
        - procs
        - ripgrep
        - rsync
        - ruby # for nvim lsp
        - shntool
        - stow
        - stress-ng
        - subfinder
        - tailscale
        - tcpdump
        - tealdeer
        - tmux
        - unzip
        - uv
        - whipper
        - wireshark
        - yt-dlp

  - type: dnf
    repos:
      copr:
        - gierth/tiny-tools
      cleanup: true
    install:
      packages:
        - RustScan
        - ansel-bin
        - blisp
        - chezmoi
        - dfu-programmer
        - eza
        - git-cliff
        - hurl
        - lazygit
        - oha
        - rainfrog
        - rs-tftpd
        - sjust
        - somo
        - systemctl-tui
        - sysz
        - trippy
        - yazi
        - zellij

  - type: files
    files:
      - source: shared-desktop
        destination: /

  - type: systemd
    system:
      enabled:
        - podman.socket
      disabled:
        - flatpak-system-update.timer

  - type: script
    snippets:
      - "echo 'Hidden=true' >> /usr/share/applications/btop.desktop"
      - "echo 'Hidden=true' >> /usr/share/applications/gcdmaster.desktop"
      - "echo 'Hidden=true' >> /usr/share/applications/nvim.desktop"
      - "echo 'Hidden=true' >> /usr/share/applications/nvtop.desktop"

  - type: kargs
    arch: x86_64, aarch64
    kargs:
      - preempt=full
      - mitigations=on
      - rd.luks.options=discard
      # - radeon.si_support=0
      # - radeon.cik_support=0
      # - amdgpu.si_support=1
      # - amdgpu.cik_support=1
      # - nouveau.config=NvGspRm=1

  - from-file: modules/ublue-packages.yaml
  - from-file: modules/virtualization.yaml
  - from-file: modules/docker.yaml
  - from-file: shared.yaml
  - from-file: modules/flatpaks.yaml
