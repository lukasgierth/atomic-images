---
name: sleepy-schaf
description: Image based on ublue Silverblue

base-image: ghcr.io/ublue-os/silverblue-main
# base-image: quay.io/fedora-ostree-desktops/silverblue
image-version: 42

modules:
  - from-file: shared-desktop.yaml
  - from-file: modules/flatpaks-gnome.yaml

  - type: dnf
    remove:
      packages:
        - gnome-classic-session
        - gnome-shell-extension-apps-menu
        - gnome-shell-extension-background-logo
        - gnome-shell-extension-launch-new-instance
        - gnome-shell-extension-places-menu
        - gnome-shell-extension-window-list
        - gnome-software
        - gnome-tour
        - gnome-tweaks
        - yelp
    install:
      packages:
        - gnome-shell-extension-caffeine

  - type: os-release
    properties:
      ID: sleepy-schaf
      ID_LIKE: fedora
      NAME: Sleepy Schaf
      PRETTY_NAME: Sleepy Schaf

  - type: script
    snippets:
      - source /etc/os-release; sed -i "s|^PRETTY_NAME=.*|PRETTY_NAME=\"${PRETTY_NAME} ${OSTREE_VERSION}\"|" /etc/os-release'

  # Needs to be at the end, because of dnf removing
  - type: script
    scripts:
      - disable-layering.sh
      - rebase_sleepy-schaf.sh

  - type: systemd
    system:
      enabled:
        - signed-autorebase.service

  - type: initramfs # only necessary for kernel/bootup/plymouth changes, do anyway here to be sure
  - type: signing # this sets up the proper policy & signing files for signed images to work fully
